{"is_source_file": true, "format": "Python", "description": "This file is the main source code for the backend API of a travel planning application built with FastAPI. It defines REST endpoints for managing users, trips, destinations, itinerary days, accommodations, activities, notes, and budget categories/expenses. The code includes route handlers, database interactions, and application setup, illustrating a comprehensive API implementation for a travel planner backend.", "external_files": ["./db", "./models", "./schemas"], "external_methods": ["get_db_session", "select", "func as sa_func"], "published": ["app", "health_check"], "classes": [{"name": "ApiMessage", "description": "Standard message response model used for health checks, deletions, and other endpoints returning simple messages."}, {"name": "UserOut", "description": "Schema for publicly exposed user data."}, {"name": "UserCreate", "description": "Schema for creating a new user."}, {"name": "TripOut", "description": "Schema for exposing trip details."}, {"name": "TripCreate", "description": "Schema for creating a new trip."}, {"name": "TripUpdate", "description": "Schema for updating trip details."}, {"name": "DestinationOut", "description": "Schema for destination details within a trip."}, {"name": "DestinationCreate", "description": "Schema for adding a destination to a trip."}, {"name": "DayOut", "description": "Schema for itinerary day details."}, {"name": "DayCreate", "description": "Schema for creating a new itinerary day."}, {"name": "AccommodationOut", "description": "Schema for accommodation details."}, {"name": "AccommodationCreate", "description": "Schema for adding a new accommodation."}, {"name": "ActivityOut", "description": "Schema for activity details."}, {"name": "ActivityCreate", "description": "Schema for creating a new activity."}, {"name": "NoteOut", "description": "Schema for note details."}, {"name": "NoteCreate", "description": "Schema for creating a new note."}, {"name": "BudgetCategoryOut", "description": "Schema for budget category details."}, {"name": "BudgetCategoryCreate", "description": "Schema for creating a new budget category."}, {"name": "BudgetCategoryUpdate", "description": "Schema for updating a budget category."}, {"name": "BudgetExpenseOut", "description": "Schema for expense entry details."}, {"name": "BudgetExpenseCreate", "description": "Schema for creating a new expense entry."}, {"name": "BudgetSummaryOut", "description": "Schema for overall budget summary including totals and per-category breakdown."}, {"name": "BudgetTotals", "description": "Schema representing total planned, actual, and remaining budget amounts."}, {"name": "BudgetCategorySummary", "description": "Schema representing individual category budget info."}], "methods": [{"name": "List[str] _get_allowed_origins()", "description": "Function to parse environment variable for CORS origins configuration.", "scope": "", "scopeKind": ""}, {"name": "DestinationOut add_destination(trip_id: UUID, payload: DestinationCreate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "AccommodationOut create_accommodation( trip_id: UUID, payload: AccommodationCreate, db: Session = Depends(get_db_session) )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ActivityOut create_activity(trip_id: UUID, payload: ActivityCreate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BudgetCategoryOut create_budget_category(trip_id: UUID, payload: BudgetCategoryCreate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BudgetExpenseOut create_budget_expense(trip_id: UUID, payload: BudgetExpenseCreate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "DayOut create_itinerary_day(trip_id: UUID, payload: DayCreate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "NoteOut create_note(trip_id: UUID, payload: NoteCreate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TripOut create_trip(payload: TripCreate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UserOut create_user(payload: UserCreate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ApiMessage delete_budget_category(trip_id: UUID, category_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ApiMessage delete_budget_expense(trip_id: UUID, expense_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ApiMessage delete_trip(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BudgetSummaryOut get_budget_summary(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TripOut get_trip(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ApiMessage health_check()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[AccommodationOut] list_accommodations(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[ActivityOut] list_activities(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[BudgetCategoryOut] list_budget_categories(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[BudgetExpenseOut] list_budget_expenses(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[DestinationOut] list_destinations(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[DayOut] list_itinerary_days(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[NoteOut] list_notes(trip_id: UUID, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[TripOut] list_trips(user_id: UUID | None = None, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list[UserOut] list_users(db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "BudgetCategoryOut update_budget_category( trip_id: UUID, category_id: UUID, payload: BudgetCategoryUpdate, db: Session = Depends(get_db_session) )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "TripOut update_trip(trip_id: UUID, payload: TripUpdate, db: Session = Depends(get_db_session))", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["select", "get_db_session", "Base.metadata.create_all", "app.add_middleware", "app.get", "app.post", "app.patch", "app.delete", "db.get", "db.add", "db.commit", "db.refresh", "db.delete", "db.scalars", "db.execute"], "search-terms": ["FastAPI", "Travel Planner", "Trip CRUD", "Destinations", "Itinerary", "Accommodations", "Activities", "Notes", "Budget categories", "Expense tracking", "API endpoints", "database models", "CORS middleware"], "state": 2, "file_id": 4, "knowledge_revision": 23, "git_revision": "a1128d4908db42da4b3171694835e591cc976fe4", "revision_history": [{"9": "4bbd4ba6f7d5edfe03ba15b15c41fa86a520b432"}, {"16": "4bbd4ba6f7d5edfe03ba15b15c41fa86a520b432"}, {"21": "a1128d4908db42da4b3171694835e591cc976fe4"}, {"22": "a1128d4908db42da4b3171694835e591cc976fe4"}, {"23": "a1128d4908db42da4b3171694835e591cc976fe4"}], "ctags": [{"_type": "tag", "name": "_get_allowed_origins", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def _get_allowed_origins() -> List[str]:$/", "language": "Python", "typeref": "typename:List[str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "add_destination", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def add_destination(trip_id: UUID, payload: DestinationCreate, db: Session = Depends(get_db_sess/", "language": "Python", "typeref": "typename:DestinationOut", "kind": "function", "signature": "(trip_id: UUID, payload: DestinationCreate, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_accommodation", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def create_accommodation($/", "language": "Python", "typeref": "typename:AccommodationOut", "kind": "function", "signature": "( trip_id: UUID, payload: AccommodationCreate, db: Session = Depends(get_db_session) )"}, {"_type": "tag", "name": "create_activity", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def create_activity(trip_id: UUID, payload: ActivityCreate, db: Session = Depends(get_db_session/", "language": "Python", "typeref": "typename:ActivityOut", "kind": "function", "signature": "(trip_id: UUID, payload: ActivityCreate, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "create_budget_category", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def create_budget_category(trip_id: UUID, payload: BudgetCategoryCreate, db: Session = Depends(g/", "language": "Python", "typeref": "typename:BudgetCategoryOut", "kind": "function", "signature": "(trip_id: UUID, payload: BudgetCategoryCreate, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "create_budget_expense", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def create_budget_expense(trip_id: UUID, payload: BudgetExpenseCreate, db: Session = Depends(get/", "language": "Python", "typeref": "typename:BudgetExpenseOut", "kind": "function", "signature": "(trip_id: UUID, payload: BudgetExpenseCreate, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "create_itinerary_day", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def create_itinerary_day(trip_id: UUID, payload: DayCreate, db: Session = Depends(get_db_session/", "language": "Python", "typeref": "typename:DayOut", "kind": "function", "signature": "(trip_id: UUID, payload: DayCreate, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "create_note", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def create_note(trip_id: UUID, payload: NoteCreate, db: Session = Depends(get_db_session)) -> No/", "language": "Python", "typeref": "typename:NoteOut", "kind": "function", "signature": "(trip_id: UUID, payload: NoteCreate, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "create_trip", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def create_trip(payload: TripCreate, db: Session = Depends(get_db_session)) -> TripOut:$/", "language": "Python", "typeref": "typename:TripOut", "kind": "function", "signature": "(payload: TripCreate, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def create_user(payload: UserCreate, db: Session = Depends(get_db_session)) -> UserOut:$/", "language": "Python", "typeref": "typename:UserOut", "kind": "function", "signature": "(payload: UserCreate, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "delete_budget_category", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def delete_budget_category(trip_id: UUID, category_id: UUID, db: Session = Depends(get_db_sessio/", "language": "Python", "typeref": "typename:ApiMessage", "kind": "function", "signature": "(trip_id: UUID, category_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "delete_budget_expense", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def delete_budget_expense(trip_id: UUID, expense_id: UUID, db: Session = Depends(get_db_session)/", "language": "Python", "typeref": "typename:ApiMessage", "kind": "function", "signature": "(trip_id: UUID, expense_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "delete_trip", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def delete_trip(trip_id: UUID, db: Session = Depends(get_db_session)) -> ApiMessage:$/", "language": "Python", "typeref": "typename:ApiMessage", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "get_budget_summary", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def get_budget_summary(trip_id: UUID, db: Session = Depends(get_db_session)) -> BudgetSummaryOut/", "language": "Python", "typeref": "typename:BudgetSummaryOut", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "get_trip", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def get_trip(trip_id: UUID, db: Session = Depends(get_db_session)) -> TripOut:$/", "language": "Python", "typeref": "typename:TripOut", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def health_check() -> ApiMessage:$/", "language": "Python", "typeref": "typename:ApiMessage", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "list_accommodations", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_accommodations(trip_id: UUID, db: Session = Depends(get_db_session)) -> list[Accommodat/", "language": "Python", "typeref": "typename:list[AccommodationOut]", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "list_activities", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_activities(trip_id: UUID, db: Session = Depends(get_db_session)) -> list[ActivityOut]:$/", "language": "Python", "typeref": "typename:list[ActivityOut]", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "list_budget_categories", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_budget_categories(trip_id: UUID, db: Session = Depends(get_db_session)) -> list[BudgetC/", "language": "Python", "typeref": "typename:list[BudgetCategoryOut]", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "list_budget_expenses", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_budget_expenses(trip_id: UUID, db: Session = Depends(get_db_session)) -> list[BudgetExp/", "language": "Python", "typeref": "typename:list[BudgetExpenseOut]", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "list_destinations", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_destinations(trip_id: UUID, db: Session = Depends(get_db_session)) -> list[DestinationO/", "language": "Python", "typeref": "typename:list[DestinationOut]", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "list_itinerary_days", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_itinerary_days(trip_id: UUID, db: Session = Depends(get_db_session)) -> list[DayOut]:$/", "language": "Python", "typeref": "typename:list[DayOut]", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "list_notes", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_notes(trip_id: UUID, db: Session = Depends(get_db_session)) -> list[NoteOut]:$/", "language": "Python", "typeref": "typename:list[NoteOut]", "kind": "function", "signature": "(trip_id: UUID, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "list_trips", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_trips(user_id: UUID | None = None, db: Session = Depends(get_db_session)) -> list[TripO/", "language": "Python", "typeref": "typename:list[TripOut]", "kind": "function", "signature": "(user_id: UUID | None = None, db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "list_users", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def list_users(db: Session = Depends(get_db_session)) -> list[UserOut]:$/", "language": "Python", "typeref": "typename:list[UserOut]", "kind": "function", "signature": "(db: Session = Depends(get_db_session))"}, {"_type": "tag", "name": "openapi_tags", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^openapi_tags = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "sa_func", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^from sqlalchemy import func as sa_func$/", "language": "Python", "kind": "unknown", "nameref": "unknown:func"}, {"_type": "tag", "name": "update_budget_category", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def update_budget_category($/", "language": "Python", "typeref": "typename:BudgetCategoryOut", "kind": "function", "signature": "( trip_id: UUID, category_id: UUID, payload: BudgetCategoryUpdate, db: Session = Depends(get_db_session) )"}, {"_type": "tag", "name": "update_trip", "path": "/home/kavia/workspace/code-generation/travel-planner-pro-281204-281213/travel_planner_backend/src/api/main.py", "pattern": "/^def update_trip(trip_id: UUID, payload: TripUpdate, db: Session = Depends(get_db_session)) -> Tr/", "language": "Python", "typeref": "typename:TripOut", "kind": "function", "signature": "(trip_id: UUID, payload: TripUpdate, db: Session = Depends(get_db_session))"}], "hash": "15a9ed8f5cfc83f54753c29b78c18d02", "format-version": 4, "code-base-name": "travel_planner_backend", "filename": "travel_planner_backend/src/api/main.py", "fields": [{"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "openapi_tags = [", "scope": "", "scopeKind": "", "description": "unavailable"}]}